<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!--

        EVERYTHING IS PHYSICAL 
        EVERYTHING IS FRACTAL
        EVERYTHING IS RECURSIVE
        NO MONEY 
        MO MINING 
        NO PROPERTY
        LOOK AT THE INSECTS
        LOOK AT THE FUNGI
        LANGUAGE IS HOW THE MIND PARSES REALITY

    -->
<link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/wAAAAD//wAA/wAAAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADMzMzQREREAAzMzRBEREQAAMzNEQREQAAAzNERBERAAAAM0REQRAAAAAEREREAAAAAAREREQAAAAAACIiIAAAAAAAIiIgAAAAAAACIgAAAAAAAAIiAAAAAAAAACAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAQAAwAEAAOADAADgAwAA8AcAAPgPAAD4DwAA/B8AAPwfAAD+PwAA/j8AAP9/AAD//wAA" rel="icon" type="image/x-icon" />

    <!--Stop Google:-->
    <META NAME="robots" CONTENT="noindex,nofollow">

</head>
<body>    
    <h1 id = "title">Marker</h1>
    <img id = "backgroundimage" src = "https://i.imgur.com/LKzo3KC.png"/>
    <img id = "editbutton" src = "iconsymbols/edit.svg" class = "button"/>
    <a id = "uplink" href = "../"><img src = "iconsymbols/uplink.svg"/></a>
    <textarea id = "wall"></textarea>


    <table id = "controltable">
        <tr>
            <td>Title:</td><td><input id = "titleinput"/></td>
        </tr>
        <tr>
            <td>Title Color:</td><td><input id = "titlecolorinput"/></td>
        </tr>
        <tr>
            <td>Image URL:</td><td><input id = "imgurlinput"/></td>
        </tr>
        <tr>
            <td>Text Color:</td><td><input id = "colorinput"/></td>
        </tr>
        <tr>
            <td>Font Size[px]:</td><td><input id = "fontsizeinput"/></td>
        </tr>
        <tr>
            <td>background color:</td><td><input id = "backgroundinput"/></td>
        </tr>
        <tr>
            <td class = "button" id = "resetbutton">RESET</td><td></td>
        </tr>
    </table>

<script>
document.getElementById("controltable").style.display =  "none";

inputs = document.getElementById("controltable").getElementsByTagName("INPUT");

readme_md = "";

var httpc2 = new XMLHttpRequest();
httpc2.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        readme_md = this.responseText;
        document.getElementById("wall").value = readme_md;
    }
};

httpc2.open("GET", "fileloader.php?filename=data/wall.txt", true);
httpc2.send();


marker = {};
var httpc3 = new XMLHttpRequest();
httpc3.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        marker = JSON.parse(this.responseText);
        redrawmarker();
        inputs[0].value = marker.title;
        inputs[1].value = marker.titlecolor;
        inputs[2].value = marker.markerimage;
        inputs[3].value = marker.color;
        inputs[4].value = marker.fontsize;
        inputs[5].value = marker.backgroundcolor;

    }
};

httpc3.open("GET", "fileloader.php?filename=data/marker.txt", true);
httpc3.send();

function redrawmarker(){
    document.getElementById("backgroundimage").src = marker.markerimage;    
    document.getElementById("title").innerHTML = marker.title;
    document.getElementById("title").style.color = marker.titlecolor;
    document.getElementById("wall").style.color = marker.color;
    document.getElementById("wall").style.fontSize = marker.fontsize.toString() + "px";
    document.getElementById("wall").style.backgroundColor = marker.backgroundcolor;
    
}


function savemarker(){
    var url = "filesaver.php";        
    var httpc2 = new XMLHttpRequest();
    httpc2.open("POST", url, true);
    httpc2.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    httpc2.send("data="+encodeURIComponent(JSON.stringify(marker,null,"    "))+"&filename=data/marker.txt");//send text to filesaver.php
}

document.getElementById("wall").onkeyup = function() {
        readme_md = this.value;
        data = encodeURIComponent(this.value);
        var httpc = new XMLHttpRequest();
        var url = "filesaver.php";        
        httpc.open("POST", url, true);
        httpc.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
        httpc.send("data="+data+"&filename=data/wall.txt");//send text to filesaver.php
}

document.getElementById("editbutton").onclick = function(){
    if(document.getElementById("controltable").style.display ==  "none"){
        document.getElementById("controltable").style.display =  "block";
    }
    else{
        document.getElementById("controltable").style.display =  "none";
    }
}


inputs[0].onchange = function(){
    marker.title = this.value;
    redrawmarker();
    savemarker();
} 

inputs[1].onchange = function(){
    marker.titlecolor = this.value;
    redrawmarker();
    savemarker();
} 
inputs[2].onchange = function(){
    marker.markerimage = this.value;
    redrawmarker();
    savemarker();
} 
inputs[3].onchange = function(){
    marker.color = this.value;
    redrawmarker();
    savemarker();
} 
inputs[4].onchange = function(){
    marker.fontsize = parseInt(this.value);
    redrawmarker();
    savemarker();
} 
inputs[5].onchange = function(){
    marker.backgroundcolor = this.value;
    redrawmarker();
    savemarker();
} 

marker0 = {
    "title": "Trailhead of path from The Vine to Maple Lawn",
    "color": "yellow",
    "titlecolor": "blue",
    "markerimage": "https://i.imgur.com/LKzo3KC.png",
    "fontsize": 30,
    "backgroundcolor":"rgba(0,0,0,0)"
}

document.getElementById("resetbutton").onclick = function(){
    marker = marker0;
    redrawmarker();
    savemarker();
}

</script>
<style>
.box{
    font-size:30px;
}
#wall{
    position:absolute;
    left:5%;
    top:29%;
    font-family:helvetica;
    font-size:26px;
    color:yellow;
    width:90%;
    height:70%;
    background-color:rgba(0,0,0,0);
}
#controltable{
    display:none;
    position:absolute;
    right:0px;
    top:0px;
    z-index:1;
    font-size:26px;
    font-family:courier;
    background-color:white;

}
#controltable input{
    width:25em;
}
#editbutton{
    position:absolute;
    left:0px;
    top:0px;
    width:50px;
}
#uplink{
    position:absolute;
    right:0px;
    top:0px;
}
#uplink img{
    width:50px;
}
.button{
    cursor:pointer;
}
.button:hover{
    background-color:green;
}
.button:active{
    background-color:yellow;
}
body{
    overflow:hidden;
}
#title{
    position:absolute;
    z-index:-2;
    top:0px;
    left:0px;
    right:0px;
    text-align:center;
    font-size:2em;
    color:black;
    font-family:Helvetica;
}
#backgroundimage{
    position:absolute;
    left:0px;
    top:0px;
    z-index:-4;
    width:100%;
}
.deletebutton{
    width:25px;
}
</style>
</body>
</html>