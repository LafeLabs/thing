<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!--

        EVERYTHING IS PHYSICAL 
        EVERYTHING IS FRACTAL
        EVERYTHING IS RECURSIVE
        NO MONEY 
        MO MINING 
        NO PROPERTY
        EVERYTHING REPLICATES
        EVERYTHING EVOLVES
        EVERYTHING DIES

        LANGUAGE IS HOW THE MIND PARSES REALITY
        
    -->
    <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbbYAAAAAAABttgAAbbYAAAAAAABttgAAbbYAAAAAAABttgAAbbYAAAAAAAAAAAAAbbYAAG22AAAAAAAA" rel="icon" type="image/x-icon" />
    <!--Stop Google:-->
    <META NAME="robots" CONTENT="noindex,nofollow">


<script>    
</script>
</head>
<body>    
<div id = "box1">
    <a href = "scroll.html">
        <img id = "scrollbutton" class = "button" style = "width:50px;" src = "iconsymbols/scroll.svg"/>
    </a>
    <a href = "map.html">
        <img id = "scrollbutton" class = "button" style = "width:50px;" src = "iconsymbols/map.svg"/>
    </a>
    <img id = "prevbutton" src = "iconsymbols/upelement.svg" class = "button" style = "width:50px"/>
    <img id = "nextbutton" src = "iconsymbols/downelement.svg" class = "button" style = "width:50px"/>
    <img id = "deletebutton" src = "iconsymbols/delete.svg" class = "button" style = "width:50px"/>
    <img id = "newbutton" src = "iconsymbols/add.svg" class = "button" style = "width:50px"/>          
</div>
<div id = "box2">
    <table id = "inputtable">
        <tr>
            <td>Name:</td>
            <td><input id = "nameinput"/></td>
        </tr>
        <tr>
            <td>Source:</td>
            <td><input id = "sourceinput"/></td>
        </tr>
        <tr>
            <td>Price:</td>
            <td><input id = "priceinput"/></td>
        </tr>
        <tr>
            <td>link:</td>
            <td><input id = "linkinput"/></td>
        </tr>
        <tr>
            <td>stock:</td>
            <td><input id = "stockinput"/></td>
        </tr>
        <tr>
            <td>onorder:</td>
            <td><input id = "onorderinput"/></td>
        </tr>
    </table>
</div>
<div id  = "tablebox">
    <H2>Inventory</H2>
    <table id = "maintable"></table>
</div>


<script>

inputs = document.getElementById("inputtable").getElementsByTagName("INPUT");


inventory = {};
inventory.data = [];
inventory.row = 0;

var httpc2 = new XMLHttpRequest();
    httpc2.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        inventory.data = JSON.parse(this.responseText);
        inventory.row = 0;
        initinventory();
    }
};
httpc2.open("GET", "fileloader.php?filename=data/inventory.txt", true);
httpc2.send();



function initinventory(){
    for(var index = 0; index < inventory.data.length; index++){
        var newtr = document.createElement("TR");
        document.getElementById("maintable").appendChild(newtr);
        var newtd = document.createElement("TD");
        newtr.appendChild(newtd);
        var newa = document.createElement("A");
        newa.href = inventory.data[index].link;
        newa.innerHTML = inventory.data[index].name;
        newa.innerHTML += "(" + inventory.data[index].source;
        newa.innerHTML += ", " + inventory.data[index].price + ")";
        var newdiv = document.createElement("DIV");
        newdiv.innerHTML = "stock:" + inventory.data[index].stock;
        newdiv.innerHTML += ", on order:" + inventory.data[index].onorder;
        newtd.appendChild(newa);
        newtd.appendChild(newdiv);

    }
    rows = document.getElementById("maintable").getElementsByTagName("TD");
    rows[inventory.row].style.backgroundColor = "#a0ffa0";
    inputtableupdate();
}

function inputtableupdate(){
    inputs[0].value = inventory.data[inventory.row].name;
    inputs[1].value = inventory.data[inventory.row].source;
    inputs[2].value = inventory.data[inventory.row].price;
    inputs[3].value = inventory.data[inventory.row].link;
    inputs[4].value = inventory.data[inventory.row].stock;
    inputs[5].value = inventory.data[inventory.row].onorder;
}

function maintableuptdate(){
    var locala = rows[inventory.row].getElementsByTagName("A")[0];
    locala.href = "inventory.data[inventory.row].link";
    locala.innerHTML = inventory.data[inventory.row].name;
    locala.innerHTML += "(" + inventory.data[inventory.row].source;
    locala.innerHTML += inventory.data[inventory.row].price + ")";
    var localdiv = rows[inventory.row].getElementsByTagName("DIV")[0]; 
    localdiv.innerHTML = "stock:" + inventory.data[inventory.row].stock;
    localdiv.innerHTML += ", on order:" + inventory.data[inventory.row].onorder;
    save();
}

document.getElementById("nextbutton").onclick = function(){
    rows[inventory.row].style.backgroundColor = "white";
    inventory.row++;
    if(inventory.row > inventory.data.length - 1){
        inventory.row = 0;
    }
    rows[inventory.row].style.backgroundColor = "#a0ffa0";
    inputtableupdate();
}
document.getElementById("prevbutton").onclick = function(){
    rows[inventory.row].style.backgroundColor = "white";
    inventory.row--;
    if(inventory.row < 0){
        inventory.row = inventory.data.length - 1;
    }
    rows[inventory.row].style.backgroundColor = "#a0ffa0";
    inputtableupdate();
}
document.getElementById("newbutton").onclick = function(){
    var newrow = {};
    newrow = inventory.data[inventory.row];
    inventory.data.push(newrow);
    var newtr = document.createElement("TR");
    document.getElementById("maintable").appendChild(newtr);
    var newtd = document.createElement("TD");
    newtr.appendChild(newtd);
    var newa = document.createElement("A");
    newa.href = newrow.link;
    newa.innerHTML = newrow.name;
    newa.innerHTML += "(" + newrow.source;
    newa.innerHTML += ", " + newrow.price + ")";
    var newdiv = document.createElement("DIV");
    newdiv.innerHTML = "stock:" + newrow.stock;
    newdiv.innerHTML += ", on order:" + newrow.onorder;
    newtd.appendChild(newa);
    newtd.appendChild(newdiv);
    rows = document.getElementById("maintable").getElementsByTagName("TD");
    rows[inventory.row].style.backgroundColor = "white";
    inventory.row = inventory.data.length - 1;
    rows[inventory.row].style.backgroundColor = "#a0ffa0";
    inputtableupdate();
    save();
}

document.getElementById("deletebutton").onclick = function(){
    rows[inventory.row].style.backgroundColor = "white";
    var temparray = [];
    for(var index = 0;index < inventory.row;index++){
        temparray.push(inventory.data[index]);
    }
    for(var index = inventory.row + 1;index < inventory.data.length;index++){
        temparray.push(inventory.data[index]);
    }
    inventory.data = temparray;
    document.getElementById("maintable").innerHTML = "";
    inventory.row = 0;
    initinventory();
    save();
    //rows[inventory.row].style.backgroundColor = "#a0ffa0";

}

inputs[0].onchange = function(){
    inventory.data[inventory.row].name = this.value;
    maintableuptdate();
}
inputs[1].onchange = function(){
    inventory.data[inventory.row].source = this.value;
    maintableuptdate();
}
inputs[2].onchange = function(){
    inventory.data[inventory.row].price = this.value;
    maintableuptdate();
}
inputs[3].onchange = function(){
    inventory.data[inventory.row].link = this.value;
    maintableuptdate();
}
inputs[4].onchange = function(){
    inventory.data[inventory.row].stock = this.value;
    maintableuptdate();
}
inputs[5].onchange = function(){
    inventory.data[inventory.row].onorder = this.value;
    maintableuptdate();
}


function save(){
    var url = "filesaver.php";        
    var httpc2 = new XMLHttpRequest();
    httpc2.open("POST", url, true);
    httpc2.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    httpc2.send("data="+encodeURIComponent(JSON.stringify(inventory.data,null,"    "))+"&filename=data/inventory.txt");//send text to filesaver.php
}

</script>
<style>
body{
    overflow:hidden;
}
input,table,select{
    font-family:courier;
    font-size:16px;
}

.button{
    cursor:pointer;
}
.button:hover{
    background-color:#50ff50;
}
.button:active{
    background-color:yellow;
}
#tablebox{

}
#maintable{
}

</style>
</body>
</html>